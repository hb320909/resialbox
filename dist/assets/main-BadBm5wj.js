import{c as J}from"./vendor-BZ0N5lZN.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function a(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=a(t);fetch(t.href,o)}})();const V="https://upznvkoiiiazvnuowhdr.supabase.co",U="sb_publishable_TaFJ0GGjMhmCGnGi4N4dyA_auGwFljE",k=J(V,U);function W(n){document.readyState==="loading"?document.addEventListener("DOMContentLoaded",n):n()}let u=[],S=[],D=[],T={};const M={Kati:"sun12",Alvaro:"rock34","Juan Ignacio":"wiz56","Maria Jose":"moon78","Jose Antonio":"thun90",Lourdes:"rain21",Ruben:"comet43",Belen:"star65",Adolfo:"king999"};function K(){rooms=[];const n=["A","B","C","D","E","F"],e=(a,s,t,o,r)=>{for(let d=a;d<=s;d++){const i=`${d}`,c={};n.forEach(m=>{c[m]=null}),rooms.push({number:i,capacity:6,occupied:0,beds:c,type:"para 6",gender:t,floor:o,side:r})}};e(101,104,"hombre",1,"izquierda"),e(201,202,"mujer",1,"derecha"),e(211,214,"hombre",2,"izquierda"),e(301,304,"mujer",2,"derecha")}function j(n){if(!n)return null;const e=new Date,a=new Date(n);if(isNaN(a))return null;let s=e.getFullYear()-a.getFullYear();const t=e.getMonth()-a.getMonth();return(t<0||t===0&&e.getDate()<a.getDate())&&s--,s}function _(){const n=new Date,e=n.getMonth()+1,a=n.getDate(),s=u.filter(t=>{if(!t.fechaNacimiento)return!1;const o=new Date(t.fechaNacimiento+"T00:00:00");if(isNaN(o))return!1;const r=o.getMonth()+1,d=o.getDate();return r===e&&d===a});s.length>0&&Y(s)}function Y(n){const e=document.getElementById("birthdayModal"),a=document.getElementById("birthdayMessage");if(n.length===1)a.textContent=`Hoy es el cumpleaÃ±os de ${n[0].nombre}`;else{const s=n.map(t=>t.nombre).join(", ");a.textContent=`Â¡Hoy es el cumpleaÃ±os de ${s}!`}e.classList.remove("hidden"),X(),setTimeout(()=>{Q()},6e3)}function Q(){document.getElementById("birthdayModal").classList.add("hidden")}function X(){const n=document.getElementById("confettiContainer");if(!n)return;n.innerHTML="";const e=50,a=["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8","#F7DC6F","#BB8FCE"];for(let s=0;s<e;s++){const t=document.createElement("div");t.className="confetti-piece absolute w-2 h-2 rounded-full",t.style.left=Math.random()*100+"%",t.style.backgroundColor=a[Math.floor(Math.random()*a.length)],t.style.animationDelay=Math.random()*.5+"s",t.style.opacity="0.8",n.appendChild(t)}}async function C(){const{data:n,error:e}=await k.from("students").select("*");u=e?[]:n,e&&console.error("Error loading students:",e);const{data:a,error:s}=await k.from("absences").select("*");S=s?[]:a,s&&console.error("Error loading absences:",s);const{data:t,error:o}=await k.from("reports").select("*");D=o?[]:t,o&&console.error("Error loading reports:",o),K(),B(),w(),O(),I(),q(),x(),te(),ne(),_(),localStorage.setItem("students",JSON.stringify(u)),localStorage.setItem("absences",JSON.stringify(S)),localStorage.setItem("reports",JSON.stringify(D))}async function Z(){await C()}Z();document.getElementById("loginForm").addEventListener("submit",function(n){n.preventDefault();const e=document.getElementById("username").value,a=document.getElementById("password").value,s=document.getElementById("loginError");M[e]&&M[e]===a?(document.getElementById("currentUser").textContent=`Bienvenido, ${e}`,document.getElementById("loginScreen").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),C(),$("dashboard"),s.classList.add("hidden")):(s.textContent="Usuario o contraseÃ±a incorrectos",s.classList.remove("hidden"))});document.getElementById("logoutBtn").addEventListener("click",function(){document.getElementById("username").value="",document.getElementById("password").value="",document.getElementById("loginScreen").classList.remove("hidden"),document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginError").classList.add("hidden")});document.querySelectorAll(".nav-link").forEach(n=>{n.addEventListener("click",function(e){e.preventDefault();const a=this.getAttribute("data-section");$(a)})});document.getElementById("mobileNav").addEventListener("change",function(){$(this.value)});document.getElementById("roomStudent")?.addEventListener("change",x);function $(n){document.querySelectorAll(".content-section").forEach(e=>{e.classList.add("hidden")}),document.getElementById(n).classList.remove("hidden")}document.getElementById("addStudentForm").addEventListener("submit",function(n){n.preventDefault();const e={id:Date.now(),nombre:document.getElementById("studentNombre").value,fechaNacimiento:document.getElementById("studentNacimiento").value,mayor16:!!document.getElementById("studentMayor16").checked,gender:document.getElementById("studentGenero").value,curso:document.getElementById("studentCurso").value,telefono1:document.getElementById("studentTelefono1").value,telefono2:document.getElementById("studentTelefono2").value,habitacion:null},a=j(e.fechaNacimiento);e.ageGroup=a!==null&&a>=18?"mayor":"menor",u.push(e),saveData(),B(),w(),x(),this.reset(),h(`Nuevo alumno aÃ±adido: ${e.nombre}`)});function B(){document.getElementById("totalAlumnos").textContent=u.length,document.getElementById("habitacionesOcupadas").textContent=rooms.filter(n=>n.occupied>0).length,document.getElementById("totalFaltas").textContent=S.length}function w(){const n=document.getElementById("studentsTableBody");if(u.length===0){n.innerHTML='<tr><td colspan="7" class="text-center py-8 text-gray-500">No hay alumnos registrados</td></tr>';return}n.innerHTML=u.map(e=>{const a=j(e.fechaNacimiento),t=new Date(e.fechaNacimiento+"T00:00:00").toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"});return`
        <tr class="border-b border-gray-100 hover:bg-gray-50">
            <td class="py-3 px-4 font-medium">${e.nombre}</td>
            <td class="py-3 px-4 text-sm">${t}</td>
            <td class="py-3 px-4"><span class="bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-sm font-medium">${a} aÃ±os</span></td>
            <td class="py-3 px-4">${e.gender||"-"}</td>
            <td class="py-3 px-4">${e.curso}</td>
            <td class="py-3 px-4 text-sm text-gray-600">${e.telefono1||"-"}${e.telefono2?"<br/>"+e.telefono2:""}</td>
            <td class="py-3 px-4">
                ${e.habitacion?`<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">${e.habitacion}</span>`:'<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">Sin asignar</span>'}
            </td>
            <td class="py-3 px-4">
                <button onclick="openStudentSeguimiento(${e.id})" title="Seguimiento acadÃ©mico" class="text-indigo-600 hover:text-indigo-800 mr-2">
                    <i class="fas fa-book"></i>
                </button>
                <button onclick="editStudent(${e.id})" class="text-blue-600 hover:text-blue-800 mr-2">
                    <i class="fas fa-edit"></i>
                </button>
                <button onclick="deleteStudent(${e.id})" class="text-red-600 hover:text-red-800">
                    <i class="fas fa-trash"></i>
                </button>
            </td>
        </tr>`}).join("")}function O(){const n=document.getElementById("roomsGrid"),e={1:{izquierda:[],derecha:[]},2:{izquierda:[],derecha:[]}};rooms.forEach(t=>{const o=t.floor||1,r=t.side||"izquierda";e[o]||(e[o]={izquierda:[],derecha:[]}),e[o][r].push(t)});const a=t=>{const o=Object.values(t.beds).filter(d=>d!==null).length,r=Object.keys(t.beds).sort();return`
        <div class="bg-white p-6 rounded-xl shadow-sm border-2 ${o===t.capacity?"border-red-300 bg-red-50":o>0?"border-yellow-300 bg-yellow-50":"border-green-300 bg-green-50"}">
            <div class="flex justify-between items-start mb-4">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">HabitaciÃ³n ${t.number}</h3>
                    <p class="text-sm text-gray-600">
                        <span class="font-medium">${t.gender==="hombre"?"ðŸ‘¨ Hombres":"ðŸ‘© Mujeres"}</span> 
                        Â· Planta ${t.floor}
                    </p>
                </div>
                <span class="px-3 py-1 rounded-full text-xs font-medium ${o===0?"bg-green-100 text-green-800":o===t.capacity?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}">${o}/${t.capacity}</span>
            </div>
            <div class="grid grid-cols-3 gap-2 mb-4">
                ${r.map(d=>{const i=t.beds[d],c=i?u.find(m=>m.id===i):null;return`
                        <div class="flex flex-col items-center p-3 rounded-lg ${c?"bg-indigo-100 border-2 border-indigo-300":"bg-gray-100 border-2 border-gray-300"}">
                            <span class="text-xs font-bold text-gray-600 mb-1">Cama ${d}</span>
                            ${c?`
                                <span class="text-xs text-center text-gray-700 font-medium">${c.nombre.split(" ")[0]}</span>
                            `:`
                                <span class="text-xs text-gray-500">Vacante</span>
                            `}
                        </div>
                    `}).join("")}
            </div>
            ${o<t.capacity?`<button onclick="assignRoomToStudent('${t.number}')" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-indigo-700 transition-colors">Asignar</button>`:""}
        </div>
    `};let s="";[1,2].forEach(t=>{const o=e[t]||{izquierda:[],derecha:[]};s+=`
            <div class="mb-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 border-b-2 border-indigo-600 pb-2">${t===1?"PLANTA 1":"PLANTA 2"}</h3>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Izquierda (Hombres) -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-4 text-center p-3 bg-blue-100 rounded-lg">ðŸ‘¨ HOMBRES (Izquierda)</h4>
                        <div class="space-y-4">
                            ${o.izquierda.length>0?o.izquierda.map(d=>a(d)).join(""):'<p class="text-gray-500 text-center py-6">No hay habitaciones de hombres</p>'}
                        </div>
                    </div>
                    
                    <!-- Derecha (Mujeres) -->
                    <div>
                        <h4 class="text-lg font-semibold text-gray-700 mb-4 text-center p-3 bg-pink-100 rounded-lg">ðŸ‘© MUJERES (Derecha)</h4>
                        <div class="space-y-4">
                            ${o.derecha.length>0?o.derecha.map(d=>a(d)).join(""):'<p class="text-gray-500 text-center py-6">No hay habitaciones de mujeres</p>'}
                        </div>
                    </div>
                </div>
            </div>
        `}),n.innerHTML=s}function I(){const n=document.getElementById("absencesTableBody"),e=document.getElementById("filterStudent").value,a=document.getElementById("filterDate").value;let s=S;if(e&&(s=s.filter(t=>t.studentId==e)),a&&(s=s.filter(t=>t.fecha===a)),s.length===0){n.innerHTML='<tr><td colspan="4" class="text-center py-8 text-gray-500">No hay faltas registradas</td></tr>';return}n.innerHTML=s.map(t=>{const o=u.find(r=>r.id===t.studentId);return`
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4 font-medium">${o?`${o.nombre}`:"Alumno eliminado"}</td>
                <td class="py-3 px-4">${t.fecha}</td>
                <td class="py-3 px-4">${t.descripcion}</td>
                <td class="py-3 px-4">
                    <button onclick="deleteAbsence(${t.id})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `}).join("")}document.getElementById("assignRoomForm").addEventListener("submit",function(n){n.preventDefault();const e=parseInt(document.getElementById("roomStudent").value),a=document.getElementById("roomNumber").value,s=document.getElementById("roomBed")?document.getElementById("roomBed").value:"",t=u.find(i=>i.id===e),o=rooms.find(i=>i.number===a);if(!t||!o)return;const r=t.gender;if(o.gender&&o.gender!=="mixta"&&r!=="otro"&&o.gender!==r){alert("La habitaciÃ³n seleccionada no es compatible con el gÃ©nero del alumno.");return}let d=null;if(s){if(o.beds[s]!==null){alert(`La cama ${s} ya estÃ¡ ocupada en esta habitaciÃ³n.`);return}d=s}else d=Object.keys(o.beds).find(i=>o.beds[i]===null);if(!d){alert("La habitaciÃ³n estÃ¡ llena. No hay camas disponibles.");return}if(t.habitacion){const i=rooms.find(c=>c.number===t.habitacion);i&&t.cama&&(i.beds[t.cama]=null,i.occupied--)}t.habitacion=a,t.cama=d,o.beds[d]=e,o.occupied++,saveData(),B(),w(),O(),x(),this.reset(),h(`Asignada habitaciÃ³n ${a} cama ${d} a ${t.nombre}`)});document.getElementById("addAbsenceForm").addEventListener("submit",function(n){n.preventDefault();const e={id:Date.now(),studentId:parseInt(document.getElementById("absenceStudent").value),fecha:document.getElementById("absenceDate").value,descripcion:document.getElementById("absenceDescription").value};S.push(e),saveData(),B(),I();const a=document.getElementById("alumnoResumenSelect");a&&a.value===e.studentId.toString()&&N(e.studentId),this.reset(),h(`Falta registrada para ${u.find(s=>s.id===e.studentId)?.nombre}`)});document.getElementById("addReportForm")?.addEventListener("submit",function(n){if(!n)return;n.preventDefault();const e={id:Date.now(),studentId:parseInt(document.getElementById("reportStudent").value),fecha:document.getElementById("reportDate").value,tipo:document.getElementById("reportType").value,descripcion:document.getElementById("reportDescription").value};D.push(e),saveData(),q();const a=document.getElementById("alumnoResumenSelect");a&&a.value===e.studentId.toString()&&N(e.studentId),this.reset(),h(`Parte registrado para ${u.find(s=>s.id===e.studentId)?.nombre}`)});function x(){["roomStudent","absenceStudent","filterStudent","seguimientoStudent"].forEach(r=>{const d=document.getElementById(r),i=d.value;d.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(c=>`
                <option value="${c.id}">${c.nombre}</option>
            `).join(""),d.value=i});const e=document.getElementById("reportStudent");if(e){const r=e.value;e.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(d=>`
                <option value="${d.id}">${d.nombre}</option>
            `).join(""),e.value=r}const a=document.getElementById("seguimientoStudent");if(a){const r=a.value;a.innerHTML='<option value="">Seleccionar alumno</option>'+u.map(d=>`
                <option value="${d.id}">${d.nombre}</option>
            `).join(""),a.value=r,a.removeEventListener("change",F),a.addEventListener("change",function(){F(this.value)})}const s=document.getElementById("alumnoResumenSelect");if(s){const r=s.value;s.innerHTML='<option value="">-- Seleccionar alumno --</option>'+u.map(d=>`
                <option value="${d.id}">${d.nombre}</option>
            `).join(""),s.value=r,s.removeEventListener("change",N),s.addEventListener("change",function(){N(this.value)})}const t=document.getElementById("roomNumber");t.innerHTML='<option value="">Seleccionar habitaciÃ³n</option>'+rooms.map(r=>`
            <option value="${r.number}">${r.number} (${r.type}, ${r.occupied}/${r.capacity})</option>
        `).join("");const o=document.getElementById("roomStudent");o&&(o.removeEventListener("change",R),o.addEventListener("change",R),R()),document.getElementById("roomBed"),t&&(t.removeEventListener("change",A),t.addEventListener("change",A),A())}function A(){const n=document.getElementById("roomNumber"),e=document.getElementById("roomBed");if(!n||!e)return;const a=n.value;if(e.innerHTML='<option value="">Seleccionar cama</option>',!a){e.disabled=!0;return}const s=rooms.find(r=>r.number===a);if(!s){e.disabled=!0;return}const t=Object.keys(s.beds).sort();let o=!1;t.forEach(r=>{const d=s.beds[r];if(d===null)o=!0,e.innerHTML+=`<option value="${r}">Cama ${r} - Vacante</option>`;else{const i=u.find(m=>m.id===d),c=i?i.nombre.split(" ")[0]:"Ocupada";e.innerHTML+=`<option value="${r}" disabled>Cama ${r} - Ocupada (${c})</option>`}}),e.disabled=!o}function R(){const n=document.getElementById("roomNumber"),e=document.getElementById("roomStudent");if(!n||!e)return;const a=parseInt(e.value);let s=rooms;if(a){const o=u.find(r=>r.id===a);if(o){const r=o.gender;s=rooms.filter(d=>d.gender===r)}}const t=n.value;n.innerHTML='<option value="">Seleccionar habitaciÃ³n</option>'+s.map(o=>{const r=o.floor===1?"Planta 1":"Planta 2",d=o.side==="izquierda"?"Izquierda":"Derecha",i=o.gender==="hombre"?"Hombres":"Mujeres";return`
                <option value="${o.number}">${o.number} - ${r} (${i}, ${d}) - ${o.occupied}/${o.capacity}</option>
            `}).join(""),n.value=t}function q(){const n=document.getElementById("reportsTableBody");if(n){if(D.length===0){n.innerHTML='<tr><td colspan="5" class="text-center py-8 text-gray-500">No hay partes registrados</td></tr>';return}n.innerHTML=D.map(e=>{const a=u.find(s=>s.id===e.studentId);return`
            <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4 font-medium">${a?`${a.nombre}`:"Alumno eliminado"}</td>
                <td class="py-3 px-4">${e.fecha}</td>
                <td class="py-3 px-4">${e.tipo}</td>
                <td class="py-3 px-4">${e.descripcion}</td>
                <td class="py-3 px-4">
                    <button onclick="deleteReport(${e.id})" class="text-red-600 hover:text-red-800">
                        <i class="fas fa-trash"></i>
                    </button>
                </td>
            </tr>
        `}).join("")}}document.getElementById("addSeguimientoForm")?.addEventListener("submit",function(n){if(!n)return;n.preventDefault();const e=parseInt(document.getElementById("seguimientoStudent").value);if(!e){alert("Seleccione un alumno para registrar el seguimiento");return}const a=document.getElementById("seguimientoAsignatura").value,s=document.getElementById("seguimientoFecha").value,t=document.getElementById("seguimientoTipo").value,o=document.getElementById("seguimientoNota").value,r=document.getElementById("seguimientoComentarios").value,d=u.find(m=>m.id===e);if(!d)return;d.academic||(d.academic={records:[]});const i={id:Date.now(),fecha:s,asignatura:a,tipo:t,nota:o,comentarios:r};d.academic.records.push(i),saveData(),F(e);const c=document.getElementById("alumnoResumenSelect");c&&c.value===e.toString()&&N(e),this.reset(),h(`Registro acadÃ©mico aÃ±adido para ${d.nombre}: ${a}`)});function N(n){const e=document.getElementById("alumnoResumenCard"),a=document.getElementById("alumnoResumenNombre"),s=document.getElementById("alumnoResumenFaltas"),t=document.getElementById("alumnoResumenPartes"),o=document.getElementById("alumnoResumenSuspensas");if(!n){e.classList.add("hidden");return}const r=u.find(m=>m.id===parseInt(n));if(!r){e.classList.add("hidden");return}const d=S.filter(m=>m.studentId===parseInt(n)).length,i=D.filter(m=>m.studentId===parseInt(n)).length;let c=0;if(r.academic&&r.academic.records){const m=f=>{if(!f)return!1;const p=(f.nota||"").toString().trim().replace(",","."),l=parseFloat(p);if(!isNaN(l))return l<5;const y=((f.tipo||"")+" "+(f.comentarios||"")+" "+(f.asignatura||"")+" "+(f.nota||"")).toLowerCase();return!!(y.includes("susp")||y.includes("suspenso")||y.includes("np")||y.includes("no presentado"))};c=r.academic.records.filter(m).length}a.textContent=r.nombre,s.textContent=d,t.textContent=i,o.textContent=c,e.classList.remove("hidden")}function F(n){const e=document.getElementById("seguimientoSummary");if(!e)return;if(!n){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-gray-500">Seleccione un alumno para ver sus suspensas por trimestre</p></div>';return}const a=u.find(d=>d.id===parseInt(n));if(!a||!a.academic||a.academic.records.length===0){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-gray-500">No hay registros para este alumno</p></div>';return}const s=d=>{if(!d)return!1;const i=(d.nota||"").toString().trim().replace(",","."),c=parseFloat(i);if(!isNaN(c))return c<5;const f=((d.tipo||"")+" "+(d.comentarios||"")+" "+(d.asignatura||"")+" "+(d.nota||"")).toLowerCase();return!!(f.includes("susp")||f.includes("suspenso")||f.includes("np")||f.includes("no presentado"))},t=a.academic.records.filter(s);if(t.length===0){e.innerHTML='<div class="text-center col-span-3 py-8"><p class="text-green-600 text-lg font-semibold"><i class="fas fa-check-circle mr-2"></i>Ninguna asignatura suspensa</p></div>';return}const o={"Trimestre 1":{count:0,color:"red"},"Trimestre 2":{count:0,color:"orange"},"Trimestre 3":{count:0,color:"red"}};t.forEach(d=>{const c=new Date(d.fecha+"T00:00:00").getMonth()+1;c>=9&&c<=11?o["Trimestre 1"].count+=1:c>=12||c<=3?o["Trimestre 2"].count+=1:c>=4&&c<=8&&(o["Trimestre 3"].count+=1)});let r="";Object.entries(o).forEach(([d,i])=>{const c=i.count===0?"bg-green-50 border-green-300":"bg-red-50 border-red-300",m=i.count===0?"text-green-800":"text-red-800",f=i.count===0?"text-green-600":"text-red-600";r+=`
            <div class="border-2 ${c} rounded-lg p-6 text-center">
                <p class="text-sm font-medium text-gray-600 mb-2">${d}</p>
                <div class="text-4xl font-bold ${m} mb-2">
                    <i class="fas ${i.count===0?"fa-check-circle":"fa-times-circle"} ${f} mr-2"></i>${i.count}
                </div>
                <p class="text-sm ${m} font-semibold">${i.count===1?"asignatura suspensa":"asignaturas suspensas"}</p>
            </div>
        `}),e.innerHTML=r}document.getElementById("filterStudent").addEventListener("change",I);document.getElementById("filterDate").addEventListener("change",I);document.getElementById("clearFilters").addEventListener("click",function(){document.getElementById("filterStudent").value="",document.getElementById("filterDate").value="",I()});function h(n){const e=document.getElementById("actividadReciente"),s=new Date().toLocaleString("es-ES"),t=document.createElement("div");for(t.className="flex items-center justify-between p-3 bg-gray-50 rounded-lg",t.innerHTML=`
        <div class="flex items-center space-x-3">
            <i class="fas fa-clock text-gray-400"></i>
            <span class="text-sm text-gray-700">${n}</span>
        </div>
        <span class="text-xs text-gray-500">${s}</span>
    `,e.children.length>0&&e.children[0].textContent.includes("No hay actividad reciente")&&(e.innerHTML=""),e.insertBefore(t,e.firstChild);e.children.length>10;)e.removeChild(e.lastChild)}function G(n){const e=new Date(n),a=(e.getDay()+6)%7;return e.setHours(0,0,0,0),e.setDate(e.getDate()-a),e.toISOString().slice(0,10)}function ee(n){const e=new Date(n+"T00:00:00");return e.setDate(e.getDate()+6),e.toISOString().slice(0,10)}function te(){const n=localStorage.getItem("homeworks");if(n)try{T=JSON.parse(n)}catch{T={}}else T={}}let H=null;function ne(){const n=document.getElementById("agendaGrid"),e=document.getElementById("weekSelector");if(!n)return;H||(H=G(new Date));const a=H,s=ee(a),t=T[a]||{},o=new Date(a+"T00:00:00"),r=new Date(s+"T00:00:00"),d=o.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"}),i=r.toLocaleDateString("es-ES",{day:"2-digit",month:"2-digit",year:"numeric"});e.textContent=`${d} â†’ ${i}`;const m=G(new Date);let p=`<div class="mb-4">
        <h3 class="text-lg font-medium">Semana: ${a} â†’ ${s}</h3>
        ${a===m?'<p class="text-sm text-green-600 font-medium"><i class="fas fa-check-circle mr-1"></i>Esta es la semana actual</p>':'<p class="text-sm text-gray-500">Semana anterior/futura</p>'}
    </div>`;p+='<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">',p+="<!-- Estudios -->";for(let l=1;l<=4;l++){const g=`estudio${l}`,y=t&&t[g]?t[g]:"",b=y.trim().length>0;p+=`
            <div class="bg-white p-4 rounded-lg border ${b?"border-indigo-300 bg-indigo-50":"border-gray-200"}">
                <h4 class="text-md font-semibold mb-2 text-gray-800">Estudio ${l}</h4>
                <textarea id="homework_${g}" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Escribe los deberes para esta semana">${y}</textarea>
                <div class="mt-3 flex items-center justify-between gap-2">
                    <button onclick="saveHomework('${g}')" class="bg-indigo-600 text-white px-4 py-2 rounded hover:bg-indigo-700 transition-colors">
                        <i class="fas fa-save mr-1"></i>Guardar
                    </button>
                    <button onclick="clearHomework('${g}')" class="text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 px-2 py-1 rounded transition-colors">
                        <i class="fas fa-trash-alt mr-1"></i>Limpiar
                    </button>
                </div>
            </div>
        `}p+="</div>",n.innerHTML=p}W(()=>{const n=document.getElementById("absenceDate");n&&(n.valueAsDate=new Date);const e=document.getElementById("reportDate");e&&(e.valueAsDate=new Date)});document.addEventListener("DOMContentLoaded",function(){C();const n=document.getElementById("loginForm");n&&n.addEventListener("submit",function(p){p.preventDefault();const l=document.getElementById("username").value,g=document.getElementById("password").value,y=document.getElementById("loginError");M[l]&&M[l]===g?(document.getElementById("currentUser").textContent=`Bienvenido, ${l}`,document.getElementById("loginScreen").classList.add("hidden"),document.getElementById("mainApp").classList.remove("hidden"),C(),$("dashboard"),y.classList.add("hidden")):(y.textContent="Usuario o contraseÃ±a incorrectos",y.classList.remove("hidden"))});const e=document.getElementById("logoutBtn");e&&e.addEventListener("click",function(){document.getElementById("username").value="",document.getElementById("password").value="",document.getElementById("loginScreen").classList.remove("hidden"),document.getElementById("mainApp").classList.add("hidden"),document.getElementById("loginError").classList.add("hidden")}),document.querySelectorAll(".nav-link").forEach(p=>{p.addEventListener("click",function(l){l.preventDefault();const g=this.getAttribute("data-section");$(g)})});const a=document.getElementById("mobileNav");a&&a.addEventListener("change",function(){$(this.value)});const s=document.getElementById("roomStudent");s&&s.addEventListener("change",x);const t=document.getElementById("addStudentForm");t&&t.addEventListener("submit",function(p){p.preventDefault();const l={id:Date.now(),nombre:document.getElementById("studentNombre").value,fechaNacimiento:document.getElementById("studentNacimiento").value,mayor16:!!document.getElementById("studentMayor16").checked,gender:document.getElementById("studentGenero").value,curso:document.getElementById("studentCurso").value,telefono1:document.getElementById("studentTelefono1").value,telefono2:document.getElementById("studentTelefono2").value,habitacion:null},g=j(l.fechaNacimiento);l.ageGroup=g!==null&&g>=18?"mayor":"menor",u.push(l),saveData(),B(),w(),x(),this.reset(),h(`Nuevo alumno aÃ±adido: ${l.nombre}`)});const o=document.getElementById("assignRoomForm");o&&o.addEventListener("submit",function(p){p.preventDefault();const l=parseInt(document.getElementById("roomStudent").value),g=document.getElementById("roomNumber").value,y=document.getElementById("roomBed")?document.getElementById("roomBed").value:"",b=u.find(E=>E.id===l),v=rooms.find(E=>E.number===g);if(!b||!v)return;const z=b.gender;if(v.gender&&v.gender!=="mixta"&&z!=="otro"&&v.gender!==z){alert("La habitaciÃ³n seleccionada no es compatible con el gÃ©nero del alumno.");return}let L=null;if(y){if(v.beds[y]!==null){alert(`La cama ${y} ya estÃ¡ ocupada en esta habitaciÃ³n.`);return}L=y}else L=Object.keys(v.beds).find(E=>v.beds[E]===null);if(!L){alert("La habitaciÃ³n estÃ¡ llena. No hay camas disponibles.");return}if(b.habitacion){const E=rooms.find(P=>P.number===b.habitacion);E&&b.cama&&(E.beds[b.cama]=null,E.occupied--)}b.habitacion=g,b.cama=L,v.beds[L]=l,v.occupied++,saveData(),B(),w(),O(),x(),this.reset(),h(`Asignada habitaciÃ³n ${g} cama ${L} a ${b.nombre}`)});const r=document.getElementById("addAbsenceForm");r&&r.addEventListener("submit",function(p){p.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("absenceStudent").value),fecha:document.getElementById("absenceDate").value,descripcion:document.getElementById("absenceDescription").value};S.push(l),saveData(),B(),I(),this.reset(),h(`Nueva falta registrada para el alumno ${u.find(g=>g.id===l.studentId)?.nombre}`)});const d=document.getElementById("addReportForm");d&&d.addEventListener("submit",function(p){p.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("reportStudent").value),fecha:document.getElementById("reportDate").value,descripcion:document.getElementById("reportDescription").value};D.push(l),saveData(),B(),q(),this.reset(),h(`Nuevo informe registrado para el alumno ${u.find(g=>g.id===l.studentId)?.nombre}`)});const i=document.getElementById("addSeguimientoForm");i&&i.addEventListener("submit",function(p){p.preventDefault();const l={id:Date.now(),studentId:parseInt(document.getElementById("seguimientoStudent").value),fecha:document.getElementById("seguimientoDate").value,descripcion:document.getElementById("seguimientoDescription").value};seguimientos[l.studentId]||(seguimientos[l.studentId]=[]),seguimientos[l.studentId].push(l),saveData(),F(l.studentId),this.reset(),h(`Nuevo seguimiento registrado para el alumno ${u.find(g=>g.id===l.studentId)?.nombre}`)});const c=document.getElementById("filterStudent");c&&c.addEventListener("change",I);const m=document.getElementById("filterDate");m&&m.addEventListener("change",I);const f=document.getElementById("clearFilters");f&&f.addEventListener("click",function(){document.getElementById("filterStudent").value="",document.getElementById("filterDate").value="",I()})});
//# sourceMappingURL=main-BadBm5wj.js.map
